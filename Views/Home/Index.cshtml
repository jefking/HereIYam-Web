
<div id="out" class="jumbotron text-center">Loading</div>

<div class="container">
    <input type="text" id="lattxt" value="500" />
    <input type="text" id="lngtxt" value="501" />
    <input type="button" id="send" value="Send" />
    <ul id="discussion"></ul>
</div>

@section scripts
{
    @*$(function() {
        var output = document.getElementById("out");

        var latitude = 666;
        var longitude = 888;
        output.innerHTML = '';

        var img = new Image();
        img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=300x300&sensor=false";

        output.appendChild(img);

        var lattxt = document.getElementById("lattxt").value = latitude;
        var longtxt = document.getElementById("lngtxt").value = longitude;
    });*@
    $(function() {

        var Geo={};

        if (navigator.geolocation) {
           navigator.geolocation.getCurrentPosition(success, error);
        }

        //Get the latitude and the longitude;
        function success(position) {
            Geo.lat = position.coords.latitude;
            Geo.lng = position.coords.longitude;
            SetItems(Geo.lat, Geo.lng);
        }

        function error(){
            console.log("Geocoder failed");
        }

        function SetItems(lat, lng){
            var output = document.getElementById("out");
            output.innerHTML = '';

            var img = new Image();
            img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + lat + "," + lng + "&zoom=13&size=300x300&sensor=false";

            output.appendChild(img);

            $('#lattxt').html(lat);
            $('#lngtxt').html(lng);
        }

    });

    $(function () {
        var hub = $.connection.geo;

        hub.client.MultiCast = function (lat, lng) {
            $('#discussion').append('<li>Latitude:&nbsp;' + lat + '&nbsp;&nbsp;&nbsp;Longitude:&nbsp;' + lng + '</li>');
        };

        $.connection.hub.start().done(function () {
            $('#send').click(function () {
                hub.server.myLocation($('#lat').val(), $('#lng').val());
            });
        });
    });
}