
<div id="map" class="jumbotron">Loading</div>

<div class="container">
    <input type="button" id="send" value="Here!" class="btn btn-default" />
</div>

@section scripts
{
    $(function() {
        var hub = $.connection.geo;
        var Geo={};

        if (navigator.geolocation) {
           navigator.geolocation.getCurrentPosition(success, error);
        }

        //Get the latitude and the longitude;
        function success(position) {
            Geo.lat = position.coords.latitude;
            Geo.lng = position.coords.longitude;
            SetItems(Geo.lat, Geo.lng);
        }

        function error(){
            console.log("Geocoder failed");
        }

        function SetItems(lat, lng){
            var myLatlng = new google.maps.LatLng(lat, lng);
            var mapOptions = {
              zoom: 13,
              center: myLatlng
            }
            var map = new google.maps.Map(document.getElementById("map"), mapOptions);

            var marker = new google.maps.Marker({
                position: myLatlng
            });

            marker.setMap(map);
        }

        hub.client.MultiCast = function (lat, lng) {
            SetItems(lat, lng)
        };

        $.connection.hub.start().done(function () {
            $('#send').click(function () {
                hub.server.myLocation(Geo.lat, Geo.lng);
            });
        });
    });
}